// pages/manegejob/manegejob.js
Page({

	/**
	 * 页面的初始数据
	 */
	data: {
		currentId: '0',
		currentTab:'0',
		yhid:"",
		organid:"",
    section: [],
		dck:[
			{name:'张三',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13112345678',ckid:'0'},
			{name:'张三',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13212345678',ckid:'1'},
			{name:'张三',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13212345678',ckid:'1'},
		],
		gtz:[
			{name:'李四',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13112345678',ckid:'2'},
			{name:'李四',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13212345678',ckid:'3'},
		],
		buheshi:[
			{name:'王五',sex:'女',year:'24',workyear:'1-3',jyzt:'待业',ypzw:'清洁工',cellphne:'13112345678',ckid:'4'},
		],
		ident:"company"
	},
	//点击头部导航的点击事件
	handleTap: function(e) {
		let id = e.currentTarget.id;
		if(id){
			this.setData({
				currentId:id,
					currentTab: id,
			})
		}
	},
	// 滚动切换标签样式 
	switchTab: function(e) {
		// console.log(e) 
		var that = this; 
		that.setData({
		 currentTab: e.detail.current,
		 currentId: e.detail.current
		}); 
	},
	//聊一聊
	talk(){
		let that = this
		let ident = that.data.ident
		wx.navigateTo({
			url: '/pages/talkjobcom/talkjobcom?userident='+ ident ,
		})
	},
	//待查看打电话
	call(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		let phonenum = e.currentTarget.dataset.cellphne
		wx.makePhoneCall({
			phoneNumber: phonenum, //仅为示例，并非真实的电话号码
			success(res){
				console.log(res)
				console.log("000")
				for(let i = 0;i<dck.length;i++){
					if(xiajiaid == dck[i].ckid){
						gtz.push(dck[i])
						dck.splice(i, 1)
						let section1 = [
							{name: '待查看',typeId: '0',num:dck.length}, 
							{name: '沟通中',typeId: '1',num:gtz.length},
							{name: '不合适',typeId: '2',num:buheshi.length},
						]
						that.setData({
							dck:dck,
							gtz:gtz,
							section:section1
						})
						
					}
				}
				let section1 = [
					{name: '待查看',typeId: '0',num:dck.length}, 
					{name: '沟通中',typeId: '1',num:gtz.length},
					{name: '不合适',typeId: '2',num:buheshi.length},
				]
				that.setData({
					dck:dck,
					buheshi:buheshi,
					section:section1
				})
			}
		})
	},
	//沟通中打电话
	callnum(e){
		let that = this
		let buheshi = that.data.buheshi
		let phonenum = e.currentTarget.dataset.cellphne
		wx.makePhoneCall({
			phoneNumber: phonenum, //仅为示例，并非真实的电话号码
		})
	},
	//不合适打电话
	bhscall(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		let phonenum = e.currentTarget.dataset.cellphne
		wx.makePhoneCall({
			phoneNumber: phonenum, //仅为示例，并非真实的电话号码
			success(res){
				console.log(res)
				for(let i = 0;i<buheshi.length;i++){
					if(xiajiaid == buheshi[i].ckid){
						gtz.push(buheshi[i])
						buheshi.splice(i, 1)
						let section1 = [
							{name: '待查看',typeId: '0',num:dck.length}, 
							{name: '沟通中',typeId: '1',num:gtz.length},
							{name: '不合适',typeId: '2',num:buheshi.length},
						]
						that.setData({
							buheshi:buheshi,
							gtz:gtz,
							section:section1
						})
						
					}
				}
				let section1 = [
					{name: '待查看',typeId: '0',num:dck.length}, 
					{name: '沟通中',typeId: '1',num:gtz.length},
					{name: '不合适',typeId: '2',num:buheshi.length},
				]
				that.setData({
					gtz:gtz,
					buheshi:buheshi,
					section:section1
				})
			}
		})
	},
	//待查看不合适点击事件
	bhs(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		console.log(e)
		for(let i = 0;i<dck.length;i++){
			if(xiajiaid == dck[i].ckid){
				wx.showModal({
					title: '提示',
					content: '是否确认不合适',
					success (res) {
						if (res.confirm) {
							buheshi.push(dck[i])
							dck.splice(i, 1)
							let section1 = [
								{name: '待查看',typeId: '0',num:dck.length}, 
								{name: '沟通中',typeId: '1',num:gtz.length},
								{name: '不合适',typeId: '2',num:buheshi.length},
							]
							that.setData({
								dck:dck,
								buheshi:buheshi,
								section:section1
							})
							
						} else if (res.cancel) {
							console.log('用户点击取消')
						}
					}
				})
				
			}
		}
		let section1 = [
			{name: '待查看',typeId: '0',num:dck.length}, 
			{name: '沟通中',typeId: '1',num:gtz.length},
			{name: '不合适',typeId: '2',num:buheshi.length},
		]
		that.setData({
			dck:dck,
			buheshi:buheshi,
			section:section1
		})
	},
	//沟通中不合适点击事件
	gtzbhs(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		console.log(e)
		for(let i = 0;i<gtz.length;i++){
			if(xiajiaid == gtz[i].ckid){
				wx.showModal({
					title: '提示',
					content: '是否确认不合适',
					success (res) {
						if (res.confirm) {
							buheshi.push(dck[i])
							gtz.splice(i, 1)
							let section1 = [
								{name: '待查看',typeId: '0',num:dck.length}, 
								{name: '沟通中',typeId: '1',num:gtz.length},
								{name: '不合适',typeId: '2',num:buheshi.length},
							]
							that.setData({
								gtz:gtz,
								buheshi:buheshi,
								section:section1
							})
							
						} else if (res.cancel) {
							console.log('用户点击取消')
						}
					}
				})
				
			}
		}
		let section1 = [
			{name: '待查看',typeId: '0',num:dck.length}, 
			{name: '沟通中',typeId: '1',num:gtz.length},
			{name: '不合适',typeId: '2',num:buheshi.length},
		]
		that.setData({
			gtz:gtz,
			buheshi:buheshi,
			section:section1
		})
	},
	//待查看聊一聊
	dcktalk(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		console.log(e)
		for(let i = 0;i<dck.length;i++){
			if(xiajiaid == dck[i].ckid){
				wx.showModal({
					title: '提示',
					content: '是否确认沟通',
					success (res) {
						if (res.confirm) {
							console.log("000")

							gtz.push(dck[i])
							dck.splice(i, 1)
							let section1 = [
								{name: '待查看',typeId: '0',num:dck.length}, 
								{name: '沟通中',typeId: '1',num:gtz.length},
								{name: '不合适',typeId: '2',num:buheshi.length},
							]
							that.setData({
								dck:dck,
								gtz:gtz,
								section:section1
							})
							let ident = that.data.ident
							wx.navigateTo({
								url: '/pages/talkjobcom/talkjobcom?userident='+ ident ,
							})
							
						} else if (res.cancel) {
							console.log('用户点击取消')
						}
					}
				})
				
			}
		}
		let section1 = [
			{name: '待查看',typeId: '0',num:dck.length}, 
			{name: '沟通中',typeId: '1',num:gtz.length},
			{name: '不合适',typeId: '2',num:buheshi.length},
		]
		that.setData({
			dck:dck,
			buheshi:buheshi,
			section:section1
		})
	},
	//不合适聊一聊
	bhstalk(e){
		let that = this
		let xiajiaid = e.currentTarget.dataset.ckid
		let dck = that.data.dck
		let gtz = that.data.gtz
		let buheshi = that.data.buheshi
		for(let i = 0;i<buheshi.length;i++){
			if(xiajiaid == buheshi[i].ckid){
				wx.showModal({
					title: '提示',
					content: '是否确认沟通',
					success (res) {
						if (res.confirm) {
							gtz.push(buheshi[i])
							buheshi.splice(i, 1)
							let section1 = [
								{name: '待查看',typeId: '0',num:dck.length}, 
								{name: '沟通中',typeId: '1',num:gtz.length},
								{name: '不合适',typeId: '2',num:buheshi.length},
							]
							that.setData({
								buheshi:buheshi,
								gtz:gtz,
								section:section1
							})
							let ident = that.data.ident
							wx.navigateTo({
								url: '/pages/talkjobcom/talkjobcom?userident='+ ident ,
							})
						} else if (res.cancel) {
							console.log('用户点击取消')
						}
					}
				})
			}
			
		}
		let section1 = [
			{name: '待查看',typeId: '0',num:dck.length}, 
			{name: '沟通中',typeId: '1',num:gtz.length},
			{name: '不合适',typeId: '2',num:buheshi.length},
		]
		that.setData({
			gtz:gtz,
			buheshi:buheshi,
			section:section1
		})
	},
	/**
	 * 生命周期函数--监听页面加载
	 */
	onLoad: function (options) {
		let that = this
		wx.getSystemInfo({
			success: function (res) {
				that.setData({
					winWidth: res.windowWidth,
					winHeight: res.windowHeight,
				});
			}
		})
		let dck = that.data.dck.length
		let gtz = that.data.gtz.length
		let buheshi = that.data.buheshi.length
		let section1 = [
			{name: '待查看',typeId: '0',num:dck}, 
			{name: '沟通中',typeId: '1',num:gtz},
			{name: '不合适',typeId: '2',num:buheshi},
		]
		that.setData({
			section:section1
		});
	},

	/**
	 * 生命周期函数--监听页面初次渲染完成
	 */
	onReady: function () {

	},

	/**
	 * 生命周期函数--监听页面显示
	 */
	onShow: function () {

	},

	/**
	 * 生命周期函数--监听页面隐藏
	 */
	onHide: function () {

	},

	/**
	 * 生命周期函数--监听页面卸载
	 */
	onUnload: function () {

	},

	/**
	 * 页面相关事件处理函数--监听用户下拉动作
	 */
	onPullDownRefresh: function () {

	},

	/**
	 * 页面上拉触底事件的处理函数
	 */
	onReachBottom: function () {

	},

	/**
	 * 用户点击右上角分享
	 */
	onShareAppMessage: function () {

	}
})
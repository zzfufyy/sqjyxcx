const { Api } = require('../../common/api');
const { Salary } = require('../../common/user');
const { UserService } = require('../../service/user_service');

const $ = require('../../utils/request_util');
const user = require('../../common/user')
const loading = require('../../utils/loading_util');

const openid = wx.getStorageSync('openid');


const createRecruitMethods = () => ({
    loadRecruiteeInfo: async function () {
        loading.begin();
        try {
            // TODO: 在一个接口里获取所有信息
            let recruiteeInfo = await UserService.loadRcruiteeInfo();
            let userInfo = await UserService.loadUserInfo();
   
            this.setData({
                // 暂时只有一个数据
                personinfo: [{
                    tximg: userInfo.avatarurl,
                    name: userInfo.nickname,
                    sex: user.genderList[recruiteeInfo.gender],
                    // TODO: 实现年龄, 电话，工作意向
                    //year: '23',
                    //cellphone: '13111111111',
                    jobname: '保洁人员',
                    money: new Salary(
                        recruiteeInfo.expectSalaryMin,
                        recruiteeInfo.expectSalaryMax,
                    ).value,
                    msgw: '34',
                    ytdgw: '127',
                    byll: recruiteeInfo.countView,
                }],
            })
        } catch (e) {
            console.error(e);
        } finally {
            loading.end();
        }
    }
});


module.exports = {
    createRecruitMethods: createRecruitMethods,
}